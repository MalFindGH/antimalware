Imports System.ComponentModel
Imports System.IO
Imports Microsoft.Win32
Imports System.Diagnostics
Imports System.Management
Imports System.Security.Cryptography
Public Class eupan

    Private Function CalculateMD5Hash(filePath As String) As String
        Try
            Using md5 As MD5 = MD5.Create
                Using stream As FileStream = File.OpenRead(filePath)
                    Dim hashbytes As Byte() = md5.ComputeHash(stream)
                    Dim sb As New System.Text.StringBuilder
                    For Each b As Byte In hashbytes
                        sb.Append(b.ToString("x2"))
                    Next
                    Return sb.ToString
                End Using
            End Using
        Catch ex As Exception
        End Try
    End Function


    Public Function additionalTasks(fn As String, fullpath As String)
        Select Case fn
            Case "Desktop.OS.dll"
                ListBox1.Items.Add("Suspicious file")
                ListBox2.Items.Add(fullpath)
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move(fullpath, "C:\EupanQuarantine\" & fn)
            Case "Dora.dat"
                ListBox1.Items.Add("Suspicious file")
                ListBox2.Items.Add(fullpath)
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move(fullpath, "C:\EupanQuarantine\" & fn)
            Case "Maintain.dat"
                ListBox1.Items.Add("Suspicious file")
                ListBox2.Items.Add(fullpath)
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move(fullpath, "C:\EupanQuarantine\" & fn)
            Case "Paladin.dat"
                ListBox1.Items.Add("Suspicious file")
                ListBox2.Items.Add(fullpath)
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move(fullpath, "C:\EupanQuarantine\" & fn)
            Case "Phoenix.dat"
                ListBox1.Items.Add("Suspicious file")
                ListBox2.Items.Add(fullpath)
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move(fullpath, "C:\EupanQuarantine\" & fn)
            Case "OptChrome.exe"
                ListBox1.Items.Add("Suspicious file")
                ListBox2.Items.Add(fullpath)

                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move(fullpath, "C:\EupanQuarantine\" & fn)
            Case "optimizer.exe"
                ListBox1.Items.Add("Suspicious file")
                ListBox2.Items.Add(fullpath)
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move(fullpath, "C:\EupanQuarantine\" & fn)
            Case "PlugIns.cache"
                ListBox1.Items.Add("Suspicious file")
                ListBox2.Items.Add(fullpath)
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move(fullpath, "C:\EupanQuarantine\" & fn)
            Case "sqlite3.exe"
                ListBox1.Items.Add("Suspicious file")
                ListBox2.Items.Add(fullpath)
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move(fullpath, "C:\EupanQuarantine\" & fn)
            Case "WebCakeDesktop.exe"
                ListBox1.Items.Add("Adware:Win32/WebCake")
                ListBox2.Items.Add(fullpath)
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move(fullpath, "C:\EupanQuarantine\" & fn)
            Case "WebCakeDesktop.Updater.exe"
                ListBox1.Items.Add("Adware:Win32/WebCake")
                ListBox2.Items.Add(fullpath)
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move(fullpath, "C:\EupanQuarantine\" & fn)
            Case "WebCakeDesktop.Updater.InstallState"
                ListBox1.Items.Add("Adware:Win32/WebCake")
                ListBox2.Items.Add(fullpath)
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move(fullpath, "C:\EupanQuarantine\" & fn)
            Case "WebCakeIEClient.dll"
                ListBox1.Items.Add("Adware:Win32/WebCake")
                ListBox2.Items.Add(fullpath)
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move(fullpath, "C:\EupanQuarantine\" & fn)
            Case "WebCakeLayers.crx"
                ListBox1.Items.Add("Suspicious file")
                ListBox2.Items.Add(fullpath)
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move(fullpath, "C:\EupanQuarantine\" & fn)
        End Select

        Registry.CurrentUser.DeleteSubKey("Software\iSearch", False)
        Registry.CurrentUser.DeleteSubKey("Software\Microsoft\Internet Explorer\MenuExt\&iSearch The Web", False)
        Registry.LocalMachine.DeleteSubKey("SOFTWARE\Classes\iSearch.Object.1", False)
        Registry.LocalMachine.DeleteSubKey("SOFTWARE\Classes\iSearch.Object", False)
        Registry.LocalMachine.DeleteSubKey("Software\Microsoft\Windows\CurrentVersion\uninstall\iSearch Toolbar_is1", False)
        Registry.LocalMachine.DeleteSubKey("SOFTWARE\HbTools", False)
        Registry.CurrentUser.DeleteSubKey("Software\HbTools", False)
        Registry.CurrentUser.DeleteSubKey("Software\AppKikxSA", False)
        Registry.CurrentUser.DeleteSubKey("Software\BlueTurtleGamesSA", False)
        Registry.CurrentUser.DeleteSubKey("Software\BrightBreezeSA", False)
        Registry.CurrentUser.DeleteSubKey("Software\CheeryChickenSA", False)
        Registry.CurrentUser.DeleteSubKey("Software\GigglingGamesSA", False)
        Registry.CurrentUser.DeleteSubKey("Software\HippoGeekSA", False)
        Registry.CurrentUser.DeleteSubKey("Software\KangoBoxSA", False)
        Registry.CurrentUser.DeleteSubKey("Software\LhootSA", False)
        Registry.CurrentUser.DeleteSubKey("Software\LukyLuSA", False)
        Registry.CurrentUser.DeleteSubKey("Software\MossySkySA", False)
        Registry.CurrentUser.DeleteSubKey("Software\RavenBleuSA", False)
        Registry.CurrentUser.DeleteSubKey("Software\SeeqDoSA", False)
        Registry.CurrentUser.DeleteSubKey("Software\ShamrockSpringSA", False)
        Registry.CurrentUser.DeleteSubKey("Software\VooMuuSA", False)
        Registry.CurrentUser.DeleteSubKey("Software\zManateeSA", False)
        If Directory.Exists("C:\Program Files\Vonteera") = True Then
            ListBox1.Items.Add("Adware:Win32/Vonteera")
            ListBox2.Items.Add("C:\Program Files\Vonteera")
            ListBox3.Items.Add("Moved to quarantine")
            Directory.Move("C:\Program Files\Vonteera", "C:\EupanQuarantine\Vonteera")
        End If
        Registry.LocalMachine.DeleteSubKey("software\microsoft\windows\currentversion\uninstall\{ad11dade-c597-45d9-d8c5-1d2eb0b89613}", False)
        Registry.CurrentUser.DeleteSubKey("Software\MySideSearch", False)
        Registry.LocalMachine.DeleteSubKey("SOFTWARE\Classes\AppID\Sidebar.DLL", False)
        Registry.LocalMachine.DeleteSubKey("SOFTWARE\Classes\AppID\{8D71EEB8-A1A7-4733-8FA2-1CAC015C967D", False)
        Registry.LocalMachine.DeleteSubKey("SOFTWARE\Classes\CLSID\{1E404D48-670A-4085-A6A0-D195793DDD33}", False)
        Registry.LocalMachine.DeleteSubKey("SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects\{9506910A-0F94-4ea1-B567-7070428B8B2B}", False)
        Registry.LocalMachine.DeleteSubKey("SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects\{11F09AFE-75AD-4E52-AB43-E09E9351CE17}", False)
    End Function

    Public Function CheckForMalware(fullPath As String, fn As String) As Boolean
        Try
            IO.Directory.CreateDirectory("C:\EupanQuarantine")
        Catch ex As Exception
        End Try

        Select Case fullPath
            Case "C:\Windows\idlemg.exe"
                ListBox1.Items.Add("Adware:Win32/ISearch")
                ListBox2.Items.Add("C:\Windows\idlemg.exe")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Windows\idlemg.exe", "C:\EupanQuarantine\idlemg.exe")
            Case "C:\Windows\System32\_toolbar.dll"
                ListBox1.Items.Add("Adware:Win32/ISearch")
                ListBox2.Items.Add("C:\Windows\System32\_toolbar.dll")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Windows\System32\_toolbar.dll", "C:\EupanQuarantine\_toolbar.dll")
            Case "C:\Windows\System32\Cache\Mte0mza6odoxmg.exe"
                ListBox1.Items.Add("Adware:Win32/ISearch")
                ListBox2.Items.Add("C:\Windows\System32\Cache\Mte0mza6odoxmg.exe")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Windows\System32\Cache\Mte0mza6odoxmg.exe", "C:\EupanQuarantine\Mte0mza6odoxmg.exe")
            Case "C:\Windows\System32\povdnrai.exe"
                ListBox1.Items.Add("Adware:Win32/ISearch")
                ListBox2.Items.Add("C:\Windows\System32\povdnrai.exe")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Windows\System32\povdnrai.exe", "C:\EupanQuarantine\povdnrai.exe")
            Case "C:\Program Files\Ibeczfrb\Ibeczfrb.exe"
                ListBox1.Items.Add("Adware:Win32/ISearch")
                ListBox2.Items.Add("C:\Program Files\Ibeczfrb\Ibeczfrb.exe")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\Ibeczfrb\Ibeczfrb.exe", "C:\EupanQuarantine\Ibeczfrb.exe")
            Case "C:\Program Files\birowser shop\z7eiujxtp.dll"
                ListBox1.Items.Add("Adware:Win32/BrowserShop")
                ListBox2.Items.Add("C:\Program Files\birowser shop\z7eiujxtp.dll")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\birowser shop\z7eiujxtp.dll", "C:\EupanQuarantine\z7eiujxtp.dll")
            Case "C:\Program Files\birowser shop\z7eiujxtp.x64.dll"
                ListBox1.Items.Add("Adware:Win32/BrowserShop")
                ListBox2.Items.Add("C:\Program Files\birowser shop\z7eiujxtp.x64.dll")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\birowser shop\z7eiujxtp.x64.dll", "C:\EupanQuarantine\z7eiujxtp.x64.dll")
            Case "C:\Users\" & Environment.UserName & "\AppData\birowser shop\4uhfhavajm.exe"
                ListBox1.Items.Add("Adware:Win32/BrowserShop")
                ListBox2.Items.Add("C:\Users\" & Environment.UserName & "\AppData\birowser shop\4uhfhavajm.exe")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Users\" & Environment.UserName & "\AppData\birowser shop\4uhfhavajm.exe", "C:\EupanQuarantine\4uhfhavajm.exe")
            Case "C:\Program Files\bonzibuddy\bonzibdy.exe"
                ListBox1.Items.Add("Adware:Win32/BonziBUDDY")
                ListBox2.Items.Add("C:\Program Files\bonzibuddy\bonzibdy.exe")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\bonzibuddy\bonzibdy.exe", "C:\EupanQuarantine\bonzibdy.exe")
            Case "C:\Program Files\bonzibuddy\bbsmartsetup.exe"
                ListBox1.Items.Add("Adware:Win32/BonziBUDDY")
                ListBox2.Items.Add("C:\")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\bonzibuddy\bbsmartsetup.exe", "C:\EupanQuarantine\bbsmartsetup.exe")
            Case "C:\Windows\System32\webcompassbar.dll"
                ListBox1.Items.Add("Adware:Win32/BonziBUDDY")
                ListBox2.Items.Add("C:\Windows\System32\webcompassbar.dll")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Windows\System32\webcompassbar.dll", "C:\EupanQuarantine\webcompassbar.dll")
            Case "C:\Windows\System32\bonzitapfilters.dll"
                ListBox1.Items.Add("Adware:Win32/BonziBUDDY")
                ListBox2.Items.Add("C:\Windows\System32\bonzitapfilters.dll")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Windows\System32\bonzitapfilters.dll", "C:\EupanQuarantine\bonzitapfilters.dll")
            Case "C:\Windows\System32\mysidesearch_sidebar.dll"
                ListBox1.Items.Add("Adware:Win32/SideSearch.A")
                ListBox2.Items.Add("C:\Windows\System32\mysidesearch_sidebar.dll")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Windows\System32\mysidesearch_sidebar.dll", "C:\EupanQuarantine\mysidesearch_sidebar.dll")
            Case "C:\Windows\System32\mysidesearch_sidebar_uninstall.exe"
                ListBox1.Items.Add("Adware:Win32/SideSearch.A")
                ListBox2.Items.Add("C:\Windows\System32\mysidesearch_sidebar_uninstall.exe")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Windows\System32\mysidesearch_sidebar_uninstall.exe", "C:\EupanQuarantine\mysidesearch_sidebar_uninstall.exe")
            Case "C:\Program Files (x86)\MixVideoPlayer\BrowserWeb.exe"
                ListBox1.Items.Add("Adware:MSIL/Bawswerps")
                ListBox2.Items.Add("C:\Program Files (x86)\MixVideoPlayer\BrowserWeb.exe")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files (x86)\MixVideoPlayer\BrowserWeb.exe", "C:\EupanQuarantine\BrowserWeb.exe")
            Case "C:\Program Files\MicroLab\SerchEngin\LanguageConvert\Uninstall.ini"
                ListBox1.Items.Add("Adware:Win32/Hebogo")
                ListBox2.Items.Add("C:\Program Files\MicroLab\SerchEngin\LanguageConvert\Uninstall.ini")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\MicroLab\SearchEngin\LanguageConvert\Uninstall.ini", "C:\EupanQuarantine\Uninstall.ini")
            Case "C:\Program Files\MicroLab\SerchEngin\LanguageConvert\Uninstall.exe"
                ListBox1.Items.Add("Adware:Win32/Hebogo")
                ListBox2.Items.Add("C:\Program Files\MicroLab\SerchEngin\LanguageConvert\Uninstall.exe")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\MicroLab\SearchEngin\LanguageConvert\Uninstall.exe", "C:\EupanQuarantine\Uninstall.exe")
            Case "C:\Program Files\MicroLab\SerchEngin\LanguageConvert\MicroLabProc.exe"
                ListBox1.Items.Add("Adware:Win32/Hebogo")
                ListBox2.Items.Add("C:\Program Files\MicroLab\SerchEngin\LanguageConvert\MicroLabProc.exe")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\MicroLab\SearchEngin\LanguageConvert\MicroLabProc.exe", "C:\EupanQuarantine\MicroLabProc.exe")
            Case "C:\Program Files\MicroLab\SerchEngin\LanguageConvert\MicroLabCon.exe"
                ListBox1.Items.Add("Adware:Win32/Hebogo")
                ListBox2.Items.Add("C:\Program Files\MicroLab\SerchEngin\LanguageConvert\MicroLabCon.exe")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\MicroLab\SearchEngin\LanguageConvert\MicroLabCon.exe", "C:\EupanQuarantine\MicroLabCon.exe")
            Case "C:\Windows\downloaded program files\cmicrolab.ocx"
                ListBox1.Items.Add("Adware:Win32/Hebogo")
                ListBox2.Items.Add("C:\Windows\downloaded program files\cmicrolab.ocx")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Windows\downloaded program files\cmicrolab.ocx", "C:\EupanQuarantine\cmicrolab.ocx")
            Case "C:\Program Files\InfoAtoms\3rd Party Licenses\buildcrx-license.txt"
                ListBox1.Items.Add("Adware:Win32/InfoAtoms")
                ListBox2.Items.Add("C:\Program Files\InfoAtoms\3rd Party Licenses\buildcrx-license.txt")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\InfoAtoms\3rd Party License\buildcrx-license.txt", "C:\EupanQuarantine\buildcrx-license.txt")
            Case "C:\Program Files\InfoAtoms\3rd Party Licenses\Info-ZIP-license.txt"
                ListBox1.Items.Add("Adware:Win32/InfoAtoms")
                ListBox2.Items.Add("C:\Program Files\InfoAtoms\3rd Party Licenses\Info-ZIP-license.txt")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\InfoAtoms\3rd Party Licenses\Info-ZIP-license.txt", "C:\EupanQuarantine\Info-ZIP-license.txt")
            Case "C:\Program Files\InfoAtoms\3rd Party Licenses\nsJSON-license.txt"
                ListBox1.Items.Add("Adware:Win32/InfoAtoms")
                ListBox2.Items.Add("C:\Program Files\InfoAtoms\3rd Party License\nsJSON-license.txt")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\InfoAtoms\3rd Party License\nsJSON-license.txt", "C:\EupanQuarantine\nsJSON-license.txt")
            Case "C:\Program Files\InfoAtoms\3rd Party Licenses\UAC-license.txt"
                ListBox1.Items.Add("Adware:Win32/InfoAtoms")
                ListBox2.Items.Add("C:\Program Files\InfoAtoms\3rd Party License\UAC-license.txt")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\InfoAtoms\3rd Party License\UAC-license.txt", "C:\EupanQuarantine\UAC-license.txt")
            Case "C:\Program Files\InfoAtoms\terms-of-service.rtf"
                ListBox1.Items.Add("Adware:Win32/InfoAtoms")
                ListBox2.Items.Add("C:\Program Files\InfoAtoms\terms-of-service.rtf")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\InfoAtoms\terms-of-service.rtf", "C:\EupanQuarantine\terms-of-service.rtf")
            Case "C:\Program Files\InfoAtoms\Uninstall.exe"
                ListBox1.Items.Add("Adware:Win32/InfoAtoms")
                ListBox2.Items.Add("C:\Program Files\InfoAtoms\Uninstall.exe")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\InfoAtoms\Uninstall.exe", "C:\EupanQuarantine\Uninstall.exe")
            Case "C:\Program Files\InfoAtoms\IE32\InfoAtomsClientIE.dll"
                ListBox1.Items.Add("Adware:Win32/InfoAtoms")
                ListBox2.Items.Add("C:\Program Files\InfoAtoms\IE32\InfoAtomsClientIE.dll")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\InfoAtoms\IE32\InfoAtomsClientIE.dll", "C:\EupanQuarantine\InfoAtomsClientIE.dll")
            Case "C:\Program Files\InfoAtoms\FireFox\infoatoms@infoatoms.com.xpi"
                ListBox1.Items.Add("Adware:Win32/InfoAtoms")
                ListBox2.Items.Add("C:\Program Files\InfoAtoms\FireFox\infoatoms@infoatoms.com.xpi")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\InfoAtoms\FireFox\infoatoms@infoatoms.com.xpi", "C:\EupanQuarantine\infoatoms@infoatoms.com.xpi")
            Case "C:\Program Files\Mozilla Firefox\defaults\preferences\!InfoAtoms.js"
                ListBox1.Items.Add("Adware:Win32/InfoAtoms")
                ListBox2.Items.Add("C:\Program Files\Mozilla Firefox\defaults\preferences\!InfoAtoms.js")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\Mozilla Firefox\defaults\preferences\!InfoAtoms.js", "C:\EupanQuarantine\!InfoAtoms.js")
            Case "C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com\chrome.manifest"
                ListBox1.Items.Add("Adware:Win32/InfoAtoms")
                ListBox2.Items.Add("C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com\chrome.manifest")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com\chrome.manifest", "C:\EupanQuarantine\chrome.manifest")
            Case "C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com\install.rdf"
                ListBox1.Items.Add("Adware:Win32/InfoAtoms")
                ListBox2.Items.Add("C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com\install.rdf")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com\install.rdf", "C:\EupanQuarantine\install.rdf")
            Case "C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com\chrome\content\browser.xul"
                ListBox1.Items.Add("Adware:Win32/InfoAtoms")
                ListBox2.Items.Add("C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com\chrome\content\browser.xul")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com\chrome\content\browser.xul", "C:\EupanQuarantine\browser.xul")
            Case "C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com\chrome\content\icon-48.png"
                ListBox1.Items.Add("Adware:Win32/InfoAtoms")
                ListBox2.Items.Add("C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com\chrome\content\icon-48.png")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com\chrome\content\icon-48.png", "C:\EupanQuarantine\icon-48.png")
            Case "C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com\chrome\content\icon-64.png"
                ListBox1.Items.Add("Adware:Win32/InfoAtoms")
                ListBox2.Items.Add("C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com\chrome\content\icon-64.png")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com\chrome\content\icon-64.png", "C:\EupanQuarantine\icon-64.png")
                IO.Directory.Move("C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com", "C:\EupanQuarantine\infoatoms@infoatoms.com")
            Case "C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com\chrome\content\vitruvian.bootstrap.js"
                ListBox1.Items.Add("Adware:Win32/InfoAtoms")
                ListBox2.Items.Add("C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com\chrome\content\vitruvian.bootstrap.js")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\Mozilla Firefox\extensions\infoatoms@infoatoms.com\chrome\content\vitruvian.bootstrap.js", "C:\EupanQuarantine\vitruvian.bootstrap.js")
            Case "C:\Users\" & Environment.UserName & "\AppData\Local\dlclient\dlclient\1.3.23.0\dlclient.exe"
                ListBox1.Items.Add("Adware:Win32/Bayads")
                ListBox2.Items.Add("C:\Users\" & Environment.UserName & "\AppData\Local\dlclient\dlclient\1.3.23.0\dlclient.exe")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Users\" & Environment.UserName & "\AppData\Local\dlclient\dlclient\1.3.23.0\dlclient.exe", "C:\EupanQuarantine\dlclient.exe")
            Case "C:\Windows\wmvploc.dll"
                ListBox1.Items.Add("Adware:Win32/Wintrim")
                ListBox2.Items.Add("C:\Windows\wmvploc.dll")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Windows\wmvploc.dll", "C:\EupanQuarantine\wmvploc.dll")
            Case "C:\Windows\svrhost.dll"
                ListBox1.Items.Add("Adware:Win32/Wintrim")
                ListBox2.Items.Add("C:\Windows\svrhost.dll")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Windows\svrhost.dll", "C:\EupanQuarantine\svrhost.dll")
            Case "C:\Windows\System32\wmvploc.dll"
                ListBox1.Items.Add("Adware:Win32/Wintrim")
                ListBox2.Items.Add("C:\Windows\System32\wmvploc.dll")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Windows\System32\wmvploc.dll", "C:\EupanQuarantine\wmvploc.dll.vir")
            Case "C:\Windows\System32\svrhost.dll"
                ListBox1.Items.Add("Adware:Win32/Wintrim")
                ListBox2.Items.Add("C:\Windows\System32\svrhost.dll")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Windows\System32\svrhost.dll", "C:\EupanQuarantine\svrhost.dll.vir")
            Case "C:\Windows\System32\host.db"
                ListBox1.Items.Add("Adware:Win32/Wintrim")
                ListBox2.Items.Add("C:\Windows\System32\host.db")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Windows\System32\host.db", "C:\EupanQuarantine\host.db")
                Registry.LocalMachine.DeleteSubKey("SOFTWARE\Classes\Srvhost.PopBlocker", False)
            Case "C:\Program Files\SaaverEextenssioin"
                ListBox1.Items.Add("Adware:Win32/SaverExtension")
                ListBox2.Items.Add("C:\Program Files\SaaverEextenssioin")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\SaaverEextenssioin", "C:\EupanQuarantine\Eextenssioin")
            Case "C:\Program Files\SaveNEiwoaAippz"
                ListBox1.Items.Add("Adware:Win32/SaverExtension")
                ListBox2.Items.Add("C:\Program Files\SaveNEiwoaAippz")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\SaveNEiwoaAippz", "C:\EupanQuarantine\SaveNEiwoaAippz")
            Case "C:\Program Files\object\bho_project.dll"
                ListBox1.Items.Add("Adware:Win32/Adkubru")
                ListBox2.Items.Add("C:\Program Files\object\bho_project.dll")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\object\bho_project.dll", "C:\EupanQuarantine\bho_project.dll")
                Registry.LocalMachine.DeleteSubKey("SOFTWARE\Classes\bho_project.bho_project", False)
                Registry.LocalMachine.DeleteSubKey("SOFTWARE\Classes\bho_project.bho_project.1", False)
            Case "C:\Program Files\ScorpionSaver"
                ListBox1.Items.Add("Adware:Win32/Adpeak")
                ListBox2.Items.Add("C:\Program Files\ScorpionSaver")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\ScropionSaver", "C:\EupanQuarantine\ScorpionSaver")
                Registry.CurrentUser.DeleteSubKey("Software\ScorpionSaver")
                Registry.CurrentUser.DeleteSubKey("Software\Adpeak, Inc.")
            Case "C:\Users\" & Environment.UserName & "\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\bm.lnk"
                ListBox1.Items.Add("Adware:Win32/Doma")
                ListBox2.Items.Add("C:\Users\" & Environment.UserName & "\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\bm.lnk")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Users\" & Environment.UserName & "\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\bm.lnk", "C:\EupanQuarantine\bm.lnk")
            Case "C:\Users\" & Environment.UserName & "\AppData\Local\Temp\tmp000000c0"
                ListBox1.Items.Add("TR/Crypt.XPACK.Gen")
                ListBox2.Items.Add("C:\Users\" & Environment.UserName & "\AppData\Local\Temp\tmp000000c0")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Users\" & Environment.UserName & "\AppData\Local\Temp\tmp000000c0", "C:\EupanQuarantine\tmp000000c0")
            Case "C:\Program Files\Common Files\pushware\cpush.dll"
                ListBox1.Items.Add("Adware:Win32/Sogou")
                ListBox2.Items.Add("C:\Program Files\Common Files\pushware\cpush.dll")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\Common Files\pushware\cpush.dll", "C:\EupanQuarantine\cpush.dll")
            Case "C:\Program Files\Common Files\pushware\uninst.exe"
                ListBox1.Items.Add("Adware:Win32/Sogou")
                ListBox2.Items.Add("C:\Program Files\Common Files\pushware\uninst.exe")
                ListBox3.Items.Add("Moved to quarantine")
                IO.File.Move("C:\Program Files\Common Files\pushware\uninst.exe", "C:\EupanQuarantine\uninst.exe")

        End Select

        Dim var As String
        var = CalculateMD5Hash(fullPath)
        Select Case var
            Case "d5012ca8a1a24bf4acd4727fd3dc3673"
                IO.File.Delete(fullPath)
                ListBox1.Items.Add("Generic.Dacic.F96EFD6C.A.9B8D7634")
                ListBox2.Items.Add(fullPath)
                ListBox3.Items.Add("Deleted")
            Case "54daad58cce5003bee58b28a4f465f49"
                IO.File.Delete(fullPath)
                ListBox1.Items.Add("Application.ProcessHacker.1")
                ListBox2.Items.Add(fullPath)
                ListBox3.Items.Add("Deleted")
            Case "b56bbaa88d90472fb3f46503f67f3658"
                ListBox1.Items.Add("Trojan:Win32/Wacatac.B!ml")
                ListBox2.Items.Add(fullPath)
                ListBox3.Items.Add("Deleted")
            Case "4a2e3c3976b92008321cae0d699cf8f5"
                ListBox1.Items.Add("Trojan.GenericKDZ.101722")
                ListBox2.Items.Add(fullPath)
                ListBox3.Items.Add("Deleted")
            Case "441fa5204ae7daf3982e316d920ca1fe"
                ListBox1.Items.Add("Gen:Variant.Barys.383057")
                ListBox2.Items.Add(fullPath)
                ListBox3.Items.Add("Deleted")
            Case "45e9fa4c141409fdb93acb87cb3a5607"
                ListBox1.Items.Add("HEUR/AGEN.1323756")
                ListBox2.Items.Add(fullPath)
                ListBox3.Items.Add("Deleted")
            Case "b010478c9560529cf0153e0ae98e22d0"
                ListBox1.Items.Add("TR/AD.RedLineSteal.njkdx")
                ListBox2.Items.Add(fullPath)
                ListBox3.Items.Add("Deleted")
            Case "4433a2d70cc87157243f2c79d797621d"
                ListBox1.Items.Add("Gen:Variant.Barys.383057")
                ListBox2.Items.Add(fullPath)
                ListBox3.Items.Add("Deleted")


        End Select

        additionalTasks(fn, fullPath)
    End Function

    Private Sub FileSystemWatcher1_Changed(sender As Object, e As FileSystemEventArgs) Handles FileSystemWatcher1.Changed
        Label4.Text = "Scanning file: " & e.FullPath

        CheckForMalware(e.FullPath, e.Name)

    End Sub

    Private Sub FileSystemWatcher1_Created(sender As Object, e As FileSystemEventArgs) Handles FileSystemWatcher1.Created
        Label4.Text = "Scanning file: " & e.FullPath

        CheckForMalware(e.FullPath, e.Name)

    End Sub

    Private Sub FileSystemWatcher1_Deleted(sender As Object, e As FileSystemEventArgs) Handles FileSystemWatcher1.Deleted
        Label4.Text = "Scanning file: " & e.FullPath
    End Sub

    Private Sub FileSystemWatcher1_Renamed(sender As Object, e As RenamedEventArgs) Handles FileSystemWatcher1.Renamed
        Label4.Text = "Scanning file: " & e.FullPath

        CheckForMalware(e.FullPath, e.Name)

    End Sub

    Private Sub LinkLabel1_LinkClicked(sender As Object, e As LinkLabelLinkClickedEventArgs) Handles LinkLabel1.LinkClicked
        FullPotentialDetectionList.Show()
    End Sub

    Private Sub eupan_Closing(sender As Object, e As CancelEventArgs) Handles Me.Closing
        My.Forms.StartAV.Close()
        My.Forms.FullPotentialDetectionList.Close()
        Application.Exit()
    End Sub

    Private Sub HideToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles HideToolStripMenuItem.Click
        My.Forms.eupan.Hide()
    End Sub

    Private Sub SeeHistoryToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles SeeHistoryToolStripMenuItem.Click
        My.Forms.eupan.Show()
    End Sub

    Private Sub BackgroundWorker1_DoWork(sender As Object, e As DoWorkEventArgs)
        Do
            For Each p As Process In Process.GetProcessesByName("sc")
                If p.MainModule.FileName.Contains("stop WinDefend") Then
                    p.Kill()
                    ListBox1.Items.Add("Disable Windows Defender")
                    ListBox2.Items.Add("C:\Windows\System32\sc.exe")
                    ListBox3.Items.Add("Trojan behavior blocked")
                End If
            Next
        Loop
    End Sub

    Private Sub Timer1_Tick(sender As Object, e As EventArgs) Handles bp.Tick
        On Error Resume Next

        For Each p As Process In Process.GetProcessesByName("vssadmin")
            p.Kill()
            ListBox1.Items.Add("Delete file backups")
            ListBox2.Items.Add("C:\Windows\System32\vssadmin.exe")
            ListBox3.Items.Add("Ransomware behavior blocked")
        Next
        For Each p As Process In Process.GetProcessesByName("netsh")
            p.Kill()
            ListBox1.Items.Add("Access firewall")
            ListBox2.Items.Add("C:\Windows\System32\netsh.exe")
            ListBox3.Items.Add("Backdoor behavior blocked")
        Next
        For Each p As Process In Process.GetProcessesByName("cscript")
            p.Kill()
            ListBox1.Items.Add("VBS Execution")
            ListBox2.Items.Add("C:\Windows\System32\cscript.exe")
            ListBox3.Items.Add("File blocked")
        Next
        For Each p As Process In Process.GetProcessesByName("wscript")
            p.Kill()
            ListBox1.Items.Add("VBS Execution")
            ListBox2.Items.Add("C:\Windows\System32\wscript.exe")
            ListBox3.Items.Add("File blocked")
        Next
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs)
        My.Forms.Settings.Show()
    End Sub

    Private Sub ransomwareProtection_Created(sender As Object, e As FileSystemEventArgs) Handles ransomwareProtection.Created
        On Error Resume Next
        If e.FullPath.Contains(".wcry") = True Then
            IO.File.Delete(e.FullPath)
        End If
    End Sub

    Private Sub eupan_Load(sender As Object, e As EventArgs) Handles MyBase.Load

    End Sub

    Private Sub ransomwareProtection_Changed(sender As Object, e As FileSystemEventArgs) Handles ransomwareProtection.Changed
        On Error Resume Next
        If e.FullPath.Contains(".wcry") = True Then
            IO.File.Delete(e.FullPath)
        End If
    End Sub

    Private Sub ransomwareProtection_Renamed(sender As Object, e As RenamedEventArgs) Handles ransomwareProtection.Renamed
        On Error Resume Next
        If e.FullPath.Contains(".wcry") = True Then
            IO.File.Delete(e.FullPath)
        End If
    End Sub

    Private Sub behavior_CheckedChanged(sender As Object, e As EventArgs) Handles behavior.CheckedChanged
        If behavior.Checked = True Then
            bp.Start()
        Else
            bp.Stop()
        End If
    End Sub
End Class
