Imports System.IO
Imports System.Security.Cryptography

Public Class Form1
    Private fileWatcher As New FileSystemWatcher("C:\Path\To\Your\Directory")
    Private maliciousHashes As New List(Of KeyValuePair(Of String, String)) From {
        New KeyValuePair(Of String, String)("SampleMaliciousHash1", "MalwareTypeA"),
        New KeyValuePair(Of String, String)("SampleMaliciousHash2", "MalwareTypeB")
        ' Add more malicious hashes with detection names here
    }

    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        AddHandler fileWatcher.Changed, Sub(sender, e) OnFileChanged(e.FullPath)
        fileWatcher.EnableRaisingEvents = True
    End Sub

    Private Sub OnFileChanged(filePath As String)
        If File.Exists(filePath) Then
            Dim fileHash = CalculateFileHash(filePath)
            If maliciousHashes.Any(Function(h) h.Key = fileHash) Then
                Dim detectionName = maliciousHashes.First(Function(h) h.Key = fileHash).Value
                Try : File.Delete(filePath) : Catch ex As Exception : MessageBox.Show("Error deleting the file: " & ex.Message) : End Try
            End If
        End If
    End Sub

    Private Function CalculateFileHash(filePath As String) As String
        Using md5 As MD5 = MD5.Create() : Return BitConverter.ToString(md5.ComputeHash(File.OpenRead(filePath))).Replace("-", "").ToLower() : End Using
    End Function
End Class
