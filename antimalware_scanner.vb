Imports System.IO
Imports System.Security.Cryptography

Public Class Form1
    Private fileWatcher As New FileSystemWatcher("C:\Path\To\Your\Directory")

    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        AddHandler fileWatcher.Changed, Sub(sender, e) OnFileChanged(e.FullPath)
        fileWatcher.EnableRaisingEvents = True
    End Sub

    Private Sub OnFileChanged(filePath As String)
        If File.Exists(filePath) Then
            Dim fileHash = CalculateFileHash(filePath)
            Select Case fileHash
                Case "SampleMaliciousHash1"
                    DeleteFile(filePath, "MalwareTypeA")
                Case "SampleMaliciousHash2"
                    DeleteFile(filePath, "MalwareTypeB")
                ' Add more cases for other malicious hashes with their corresponding detection names here
            End Select
        End If
    End Sub

    Private Function CalculateFileHash(filePath As String) As String
        Using md5 As MD5 = MD5.Create()
            Return BitConverter.ToString(md5.ComputeHash(File.OpenRead(filePath))).Replace("-", "").ToLower()
        End Using
    End Function

    Private Sub DeleteFile(filePath As String, detectionName As String)
        Try
            File.Delete(filePath)
            ' You can log, show a message box, or take any other action based on the detection name
            ' For example, MessageBox.Show("Detected '" & detectionName & "' malware in the file: " & filePath)
        Catch ex As Exception
            MessageBox.Show("Error deleting the file: " & ex.Message)
        End Try
    End Sub
End Class
