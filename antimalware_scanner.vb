Imports System.IO
Imports System.Security.Cryptography

Public Class Form1

    ' List to store the names of malicious files found
    Private maliciousFiles As New List(Of String)

    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        ' Start the scanning process when the form is loaded
        ScanDirectory("C:\")
    End Sub

    Private Sub ScanDirectory(folderPath As String)
        Try
            ' Get all the files in the current directory
            Dim files As String() = Directory.GetFiles(folderPath)

            For Each file As String In files
                ' Calculate the MD5 hash of the file
                Dim fileHash As String = CalculateFileHash(file)

                ' Check for each category of threat based on corresponding checkboxes
                If ScanForAdware.Checked Then
                    Select Case fileHash
                        Case "your-adware-md5-hash-1"
                            ' Add the name of the detected adware file to ListBox1
                            ListBox1.Items.Add("Adware File 1: " & file)
                            maliciousFiles.Add(file)
                        Case "your-adware-md5-hash-2"
                            ListBox1.Items.Add("Adware File 2: " & file)
                            maliciousFiles.Add(file)
                        ' Add more cases for other adware MD5 hashes as needed
                    End Select
                End If

                ' You can add more conditions for different threat categories
                ' For example, if you have another checkbox "ScanForSpyware", you can do:
                ' If ScanForSpyware.Checked Then
                '    Select Case fileHash
                '        Case "your-spyware-md5-hash-1"
                '            ListBox1.Items.Add("Spyware File 1: " & file)
                '            maliciousFiles.Add(file)
                '        Case "your-spyware-md5-hash-2"
                '            ListBox1.Items.Add("Spyware File 2: " & file)
                '            maliciousFiles.Add(file)
                '        ' Add more cases for other spyware MD5 hashes as needed
                '    End Select
                ' End If

                ' Add other threat categories using similar patterns if needed
            Next

            ' Get all the subdirectories in the current directory
            Dim subdirectories As String() = Directory.GetDirectories(folderPath)

            For Each subdirectory As String In subdirectories
                ' Recursively scan the subdirectory
                ScanDirectory(subdirectory)
            Next
        Catch ex As Exception
            ' Handle any exceptions that might occur during the scanning process
            MessageBox.Show("Error while scanning: " & ex.Message)
        End Try
    End Sub

    Private Function CalculateFileHash(filePath As String) As String
        Using md5 As MD5 = MD5.Create()
            Using stream As FileStream = File.OpenRead(filePath)
                Dim hashBytes As Byte() = md5.ComputeHash(stream)
                Return BitConverter.ToString(hashBytes).Replace("-", String.Empty)
            End Using
        End Using
    End Function

End Class
