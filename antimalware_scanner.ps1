# Ask the user for the file path using a console prompt
$scanfile = Read-Host "Enter the file path to scan (raw format):"

# Check if the provided file path is valid
if (-not (Test-Path $scanfile)) {
    Write-Host "Invalid file path. Please provide a valid path."
    exit 1
}

# Initialize the variable to keep track of the malware score
$malware_score = 0

# Read the contents of the file
try {
    $fileContent = Get-Content -Path $scanfile -Raw
}
catch {
    Write-Host "Error reading the file: $_"
    exit 1
}

# List of strings to search for in the file
$malicious_strings = @(
    "malware",
    "virus",
    "trojan",
    "ransomware"
    # Add more strings here if needed
)

# Loop through the list of malicious strings and check if they exist in the file
foreach ($malicious_string in $malicious_strings) {
    $count = ($fileContent | Select-String -Pattern $malicious_string -AllMatches).Matches.Count
    if ($count -gt 0) {
        $malware_score += $count
        Write-Host "Found $count occurrence(s) of '$malicious_string' in the file."
    }
}

# Display the final malware score
Write-Host "Malware_score is $malware_score."
